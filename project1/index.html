<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>Ember Starter Kit</title>
  <link rel="stylesheet" href="css/normalize.css">
  <link rel="stylesheet" href="css/style.css">

</head>
<body>
  <div class="container" style="position:absolute; left:100px;">
    <svg id="svg" >
    </svg>
  </div>


  
  <script src="http://d3js.org/d3.v3.min.js" charset="utf-8"></script>
  <script src="js/libs/jquery-1.10.2.js"></script>
  <script src="js/libs/handlebars-1.1.2.js"></script>
  <script src="js/libs/ember-1.5.1.js"></script>
  <script src="js/app.js"></script>
  <script src="tests/runner.js"></script>
  <script src="assets/dataset.js" type="text/javascript"></script>
  <script>
  
var Chart = function(dataset){
      this.dataset = dataset;
      var svgW = 1000, svgH = 400;
      var height_factor=40;
      var plot = function() {

        var svg = this.attr("width", svgW)
          .attr("height", svgH);
          

        svg.selectAll("rect.title")
          .data(function(d){ return d;})
          .call(drawRectangles)
          .enter().append('rect')
          .call(drawRectangles);


        svg.selectAll("rect.value")
          .data(function(d){ return d;})
          .call(drawRectangles2)
          .enter().append('rect')
          .call(drawRectangles2);

      }

      
      var drawRectangles = function(selection) {
        var barW = svgW/(selection.size()+1);
        var barPadding = 2;
       
        this.attr("x", function(d,i){return ((i-2)*(barW) ); })
        .attr("y", function(d){return svgH - (d.revenue * height_factor)})
        .attr("width", 11)
        .attr("height", function(d){return (d.revenue * height_factor)})
        .attr("fill", "teal");

        return this;
      }

        var drawRectangles2 = function(selection) {
        var barW = svgW/(selection.size()+1);
        var barPadding = 2;
       
        this.attr("x", function(d,i){return 0.5*barW+((i-2)*(barW) ); })
        .attr("y", function(d){return svgH - (d.revenue * height_factor)})
        .attr("width", 11)
        .attr("height", function(d){return (d.cost * height_factor)})
        .attr("fill", "red");

        return this;
      }

      return plot;
    };


  var chart = new Chart();
  var shuffledData = dataset;
  d3.select("svg")
      .data([shuffledData])
      .call(chart);


   </script>
</body>
</html>
